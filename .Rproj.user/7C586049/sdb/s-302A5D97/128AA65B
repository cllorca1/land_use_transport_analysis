{
    "collab_server" : "",
    "contents" : "pacman::p_load(data.table, dplyr, ggplot2)\n\npath = \"c:/models/silo/muc/mitoOutput/\"\n#path = \"c:/models/silo/muc/mitoOutput/\"\nyears = c(2024,2037)\nfileEnding = \"/trips.csv\"\n\nallYears = data.frame()\n\nfor (year in years){\n  dataThisYear = fread(paste(path,year,fileEnding, sep = \"\"))\n  summary = dataThisYear %>% group_by(purpose, mode) %>% summarize(count = n(),\n                                                                   distance = mean(distance),\n                                                                   time = mean(time_auto))\n  summary$year = year\n  \n  summary[is.null(summary)] = \"null\"\n  summary[is.na(summary)] = 0\n  summary = as.data.frame(summary)\n  allYears = as.data.frame(rbind(allYears,summary))\n}\n\n#add the base year trip list###############################\n#check that this file is still there and it is the trip list of 2011\nfile_2011 = \"c:/models/mito/muc/mitoMunich/mitoOutput/0/trips.csv\"\ndataThisYear = fread(file_2011)\nsummary = dataThisYear %>% group_by(purpose, mode) %>% summarize(count = n(),\n                                                                 distance = mean(distance),\n                                                                 time = mean(time_auto))\nsummary$year = 2011\nsummary[is.null(summary)] = \"null\"\nsummary[is.na(summary)] = 0\nsummary = as.data.frame(summary)\nallYears = as.data.frame(rbind(allYears,summary))\n\n#start analysis###########################################\n\n#put columns in order # to paste in Excel\n# allYears = allYears %>% select(purpose, mode, count, distance, year, time)\n\n#modal share by year\nallYears = filter(allYears, mode != \"null\")\n\nggplot(allYears, aes(x=as.factor(year), y=count, fill = mode)) + \n  geom_bar(position = \"fill\", stat = \"identity\") +  \n  scale_fill_manual(values = c(\"#64A0C8\", \"#003359\", \"#A5A5A5\", \"#FFC000\",\"#E37222\", \"#74390F\", \"#92D050\" )) + \n  theme_light() + facet_grid(.~purpose)\n\n\nggplot(allYears, aes(x=as.factor(year), y=count, fill = mode)) + \n  geom_bar(stat = \"identity\") +  \n  scale_fill_manual(values = c(\"#64A0C8\", \"#003359\", \"#A5A5A5\", \"#FFC000\",\"#E37222\", \"#74390F\", \"#92D050\" )) + \n  theme_light()\n\n\nggplot(allYears, aes(x=as.factor(year), y=count, fill = mode)) + \n  geom_bar(stat = \"identity\") +  \n  scale_fill_manual(values = c(\"#64A0C8\", \"#003359\", \"#A5A5A5\", \"#FFC000\",\"#E37222\", \"#74390F\", \"#92D050\" )) + \n  theme_light() + facet_grid(.~purpose)\n\n\nggplot(allYears, aes(x=as.factor(year), y=distance, group = mode, color = mode)) + \n  geom_line(size = 1) +  \n  scale_color_manual(values = c(\"#64A0C8\", \"#003359\", \"#A5A5A5\", \"#FFC000\",\"#E37222\", \"#74390F\", \"#92D050\" )) + \n  theme_light() + facet_grid(.~purpose)\n\nggplot(allYears, aes(x=as.factor(year), y=time, group = mode, color = mode)) + \n  geom_line(size = 1) +  \n  scale_color_manual(values = c(\"#64A0C8\", \"#003359\", \"#A5A5A5\", \"#FFC000\",\"#E37222\", \"#74390F\", \"#92D050\" )) + \n  theme_light() + facet_grid(.~purpose)\n\n\n#calculate modal shares by distance\ndistanceBins = seq(0,50,2)\n\nfor (year in years){\n  dataThisYear = fread(paste(path,year,fileEnding, sep = \"\"))\n  dataThisYear$distance_bin = cut(x=dataThisYear$distance, breaks = distanceBins)\n  \n  summaryThisYear = dataThisYear %>% group_by(mode, distance_bin) %>% summarize(trips = n())\n  total_trips = nrow(dataThisYear)\n  \n  summaryThisYear = summaryThisYear %>% filter(mode != \"null\")\n  \n  print(\n    ggplot() + \n      geom_area(data = summaryThisYear, aes(x=distance_bin, y=trips, group = as.factor(mode), fill = as.factor(mode)), position = \"fill\") + \n      ggtitle(paste(\"Shares by distance in\",year)) + \n      scale_fill_manual(values = c(\"#64A0C8\", \"#003359\", \"#A5A5A5\", \"#FFC000\",\"#E37222\", \"#74390F\", \"#92D050\" ))\n  )\n  print(\n    ggplot(dataThisYear %>% filter(mode == \"autoDriver\"), aes(x=distance, color = as.factor(purpose))) +\n      geom_freqpoly(size = 1.5) + \n      ggtitle(paste(\"Distance distribution by purpose for car trips in\",year))\n  )\n  print(\n    ggplot(dataThisYear %>% filter(mode == \"autoDriver\"), aes(x=distance)) +\n      geom_freqpoly(size = 1.5) +\n      ggtitle(paste(\"Distance distribution for car trips in\",year))\n  )\n}\n\n\n",
    "created" : 1533020523745.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2054458458",
    "id" : "128AA65B",
    "lastKnownWriteTime" : 1533021362,
    "last_content_update" : 1533021362729,
    "path" : "C:/code/silo_output_analyzer/mito/mito_trip_list_reader.R",
    "project_path" : "mito/mito_trip_list_reader.R",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}